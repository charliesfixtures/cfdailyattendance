<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8"/>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
</head>
<body>
<script>
(function() {
  var BASE_URL = 'https://charliesfixtures.github.io/cfdailyattendance/';

  TrelloPowerUp.initialize({

    // ── Card back section ────────────────────────────────────
    // Only renders on cards whose name contains "Attendance"
    'card-back-section': function(t) {
      return t.card('name').then(function(card) {

        // Check if card name contains "Attendance" (case-insensitive)
        if (!card.name.toLowerCase().includes('attendance')) {
          return null; // Return nothing — section hidden on all other cards
        }

        return {
          title: 'Daily Attendance',
          icon:  BASE_URL + 'icon.svg',
          content: {
            type:   'iframe',
            url:    t.signUrl(BASE_URL + 'index.html'),
            height: 35, // starts small, index.html sizeTo expands it
          },
        };

      });
    },

    // ── Board toolbar button (optional quick access) ─────────
    'board-buttons': function(t) {
      return [{
        icon: { dark: BASE_URL + 'icon.svg', light: BASE_URL + 'icon.svg' },
        text: 'Attendance',
        callback: function(t) {
          return t.popup({
            title:  'CF Daily Attendance',
            url:    BASE_URL + 'index.html',
            height: 800,
          });
        }
      }];
    },

  }, {
    appKey:  '53abc1f4686798eadbeb8f91ea79c9bb',
    appName: 'CF Daily Attendance',
  });
})();
</script>
</body>
</html>
